CVE ID,Vulnerable Code,Patched Code
CVE-2024-0001,"def login(username, password):
    query = f""SELECT * FROM users WHERE username='{username}' AND password='{password}'""
    execute(query)
    ","def login(username, password):
    query = ""SELECT * FROM users WHERE username=? AND password=?""
    execute(query, (username, password))
    "
CVE-2024-0002,"def get_user_info(user_id):
    query = f""SELECT * FROM users WHERE id={user_id}""
    execute(query)
    ","def get_user_info(user_id):
    query = ""SELECT * FROM users WHERE id=?""
    execute(query, (user_id,))
    "
CVE-2024-0003,"def set_data(user_input):
    data = ""User input: "" + user_input
    print(data)
    ","def set_data(user_input):
    data = ""User input: "" + sanitize(user_input)
    print(data)
    "
CVE-2024-0004,"def delete_user(user_id):
    query = f""DELETE FROM users WHERE id={user_id}""
    execute(query)
    ","def delete_user(user_id):
    query = ""DELETE FROM users WHERE id=?""
    execute(query, (user_id,))
    "
CVE-2024-0005,"def update_account(account_id, new_email):
    query = f""UPDATE accounts SET email='{new_email}' WHERE id={account_id}""
    execute(query)
    ","def update_account(account_id, new_email):
    query = ""UPDATE accounts SET email=? WHERE id=?""
    execute(query, (new_email, account_id))
    "
CVE-2024-0006,"def get_file(filename):
    with open(f""/etc/{filename}"", 'r') as f:
        return f.read()
    ","def get_file(filename):
    with open(os.path.join(""/etc"", sanitize(filename)), 'r') as f:
        return f.read()
    "
CVE-2024-0007,"def unsafe_concat(input_str):
    result = ""Prefix-"" + input_str
    print(result)
    ","def unsafe_concat(input_str):
    result = ""Prefix-"" + sanitize(input_str)
    print(result)
    "
CVE-2024-0008,"def retrieve_data(user_id):
    query = f""SELECT * FROM data WHERE id={user_id}""
    execute(query)
    ","def retrieve_data(user_id):
    query = ""SELECT * FROM data WHERE id=?""
    execute(query, (user_id,))
    "
CVE-2024-0009,"def authenticate(token):
    query = f""SELECT * FROM tokens WHERE token='{token}'""
    execute(query)
    ","def authenticate(token):
    query = ""SELECT * FROM tokens WHERE token=?""
    execute(query, (token,))
    "
CVE-2024-0010,"def insecure_comparison(user_input):
    if user_input == 'secret_key':
        return True
    return False
    ","def insecure_comparison(user_input):
    if secure_compare(user_input, 'secret_key'):
        return True
    return False
    "
